{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///Users/nui/Documents/trip/JoyTrip-main-v2/src/app/components/Navbar.tsx"],"sourcesContent":["'use client';\n\nimport Link from 'next/link';\nimport Image from 'next/image';\n\nexport default function Navbar() {\n  return (\n    <nav className=\"sticky top-0 bg-white shadow z-50\">\n      <div className=\"max-w-6xl mx-auto px-6 py-4 flex items-center justify-between\">\n        {/* Left: Brand with Logo */}\n        <div className=\"flex items-center space-x-3\">\n          {/* Logo */}\n          <Image \n            src=\"/logo.jpg\" \n            alt=\"JoyTrip Logo\" \n            width={40}\n            height={40} \n            className=\"rounded-full\" // ทำให้โลโก้เป็นวงกลม\n          />\n          {/* Brand Name */}\n          <div className=\"text-2xl font-bold text-blue-600\">JoyTrip</div>\n        </div>\n\n        {/* Center: Navigation links */}\n        <ul className=\" hidden md:flex space-x-6 text-gray-700 absolute left-1/2 transform -translate-x-1/2\">\n          <li><Link href=\"/\">Home</Link></li>\n          <li><Link href=\"/#about\">About</Link></li>\n          <li><Link href=\"/#features\">Features</Link></li>\n          <li><Link href=\"/#contact\">Contact</Link></li>\n        </ul>\n\n        {/* Right: CTA */}\n        <Link\n          href=\"/chat\"\n          className=\"hidden md:block bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700\"\n        >\n          Create a Trip\n        </Link>\n      </div>\n    </nav>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;;AAKe,SAAS;IACtB,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BAEb,8OAAC;oBAAI,WAAU;;sCAEb,8OAAC,6HAAA,CAAA,UAAK;4BACJ,KAAI;4BACJ,KAAI;4BACJ,OAAO;4BACP,QAAQ;4BACR,WAAU,eAAe,sBAAsB;;;;;;sCAGjD,8OAAC;4BAAI,WAAU;sCAAmC;;;;;;;;;;;;8BAIpD,8OAAC;oBAAG,WAAU;;sCACZ,8OAAC;sCAAG,cAAA,8OAAC,4JAAA,CAAA,UAAI;gCAAC,MAAK;0CAAI;;;;;;;;;;;sCACnB,8OAAC;sCAAG,cAAA,8OAAC,4JAAA,CAAA,UAAI;gCAAC,MAAK;0CAAU;;;;;;;;;;;sCACzB,8OAAC;sCAAG,cAAA,8OAAC,4JAAA,CAAA,UAAI;gCAAC,MAAK;0CAAa;;;;;;;;;;;sCAC5B,8OAAC;sCAAG,cAAA,8OAAC,4JAAA,CAAA,UAAI;gCAAC,MAAK;0CAAY;;;;;;;;;;;;;;;;;8BAI7B,8OAAC,4JAAA,CAAA,UAAI;oBACH,MAAK;oBACL,WAAU;8BACX;;;;;;;;;;;;;;;;;AAMT","debugId":null}},
    {"offset": {"line": 175, "column": 0}, "map": {"version":3,"sources":["file:///Users/nui/Documents/trip/JoyTrip-main-v2/src/app/components/Footer.tsx"],"sourcesContent":["'use client';\n\nimport Image from 'next/image';\n\nexport default function Footer() {\n  return (\n    <footer id=\"contact\" className=\"bg-gray-900 text-gray-300 py-8 px-6 text-center\">\n      <p className=\"mb-4 text-lg\">\n        Have any questions? {' '}\n        contact via LINE\n      </p>\n      <Image\n        src=\"/qr.JPG\"\n        alt=\"QR Code\"\n        className='ml-150 mb-10'\n        width={200}\n        height={200}\n      />\n\n      <p className=\"text-sm\">© {new Date().getFullYear()} JoyTrip. All rights reserved.</p>\n    </footer>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AAFA;;;AAIe,SAAS;IACtB,qBACE,8OAAC;QAAO,IAAG;QAAU,WAAU;;0BAC7B,8OAAC;gBAAE,WAAU;;oBAAe;oBACL;oBAAI;;;;;;;0BAG3B,8OAAC,6HAAA,CAAA,UAAK;gBACJ,KAAI;gBACJ,KAAI;gBACJ,WAAU;gBACV,OAAO;gBACP,QAAQ;;;;;;0BAGV,8OAAC;gBAAE,WAAU;;oBAAU;oBAAG,IAAI,OAAO,WAAW;oBAAG;;;;;;;;;;;;;AAGzD","debugId":null}},
    {"offset": {"line": 236, "column": 0}, "map": {"version":3,"sources":["file:///Users/nui/Documents/trip/JoyTrip-main-v2/src/app/components/ChatMessage.tsx"],"sourcesContent":["'use client';\n\nimport { FC } from 'react';\n\ninterface WeatherInfo {\n  location: string;\n  temperature: number;\n  condition: string;\n}\n\ninterface ChatMessageProps {\n  role: 'user' | 'bot';\n  text: string;\n  weather?: WeatherInfo;\n}\n\nconst ChatMessage: FC<ChatMessageProps> = ({ role, text, weather }) => {\n  return (\n    <div className={`flex ${role === 'user' ? 'justify-end' : 'justify-start'}`}>\n      <div\n        className={`px-5 py-3 rounded-lg shadow-md max-w-[80%] ${\n          role === 'user'\n            ? 'bg-blue-600 text-white rounded-br-none'\n            : 'bg-gray-100 text-gray-800 rounded-bl-none'\n        }`}\n      >\n        <div className=\"whitespace-pre-wrap\">{text}</div>\n        \n        {/* แสดงข้อมูลสภาพอากาศถ้ามี */}\n        {weather && (\n          <div className=\"mt-3 pt-3 border-t border-gray-300\">\n            <div className=\"flex items-center\">\n              <svg \n                xmlns=\"http://www.w3.org/2000/svg\" \n                width=\"24\" \n                height=\"24\" \n                viewBox=\"0 0 24 24\" \n                fill=\"none\" \n                stroke=\"currentColor\" \n                strokeWidth=\"2\" \n                strokeLinecap=\"round\" \n                strokeLinejoin=\"round\" \n                className=\"mr-2\"\n              >\n                <path d=\"M12 2a8 8 0 0 1 8 8c0 2.76-.98 5-2.2 6.7-1.2 1.7-2.8 2.8-4.8 3.3-.8.2-1.3-.1-1-1 .2-.6.3-1.2.4-1.8.1-.7-.4-1.2-1.1-1.2h-2.6c-.7 0-1.2.5-1.1 1.2.1.6.2 1.2.4 1.8.3.9-.2 1.2-1 1-2-.5-3.6-1.6-4.8-3.3C1 15 0 12.8 0 10a8 8 0 0 1 8-8h4z\"/>\n              </svg>\n              <span className=\"font-medium\">{weather.location}: </span>\n              <span className=\"ml-1\">{weather.temperature}°C, {weather.condition}</span>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default ChatMessage;\n"],"names":[],"mappings":";;;;AAAA;;AAgBA,MAAM,cAAoC,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE;IAChE,qBACE,8OAAC;QAAI,WAAW,CAAC,KAAK,EAAE,SAAS,SAAS,gBAAgB,iBAAiB;kBACzE,cAAA,8OAAC;YACC,WAAW,CAAC,2CAA2C,EACrD,SAAS,SACL,2CACA,6CACJ;;8BAEF,8OAAC;oBAAI,WAAU;8BAAuB;;;;;;gBAGrC,yBACC,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCACC,OAAM;gCACN,OAAM;gCACN,QAAO;gCACP,SAAQ;gCACR,MAAK;gCACL,QAAO;gCACP,aAAY;gCACZ,eAAc;gCACd,gBAAe;gCACf,WAAU;0CAEV,cAAA,8OAAC;oCAAK,GAAE;;;;;;;;;;;0CAEV,8OAAC;gCAAK,WAAU;;oCAAe,QAAQ,QAAQ;oCAAC;;;;;;;0CAChD,8OAAC;gCAAK,WAAU;;oCAAQ,QAAQ,WAAW;oCAAC;oCAAK,QAAQ,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOhF;uCAEe","debugId":null}},
    {"offset": {"line": 337, "column": 0}, "map": {"version":3,"sources":["file:///Users/nui/Documents/trip/JoyTrip-main-v2/src/app/utils/n8nService.ts"],"sourcesContent":["/**\n * Service to handle communication with n8n webhook\n */\n\n// ปรับ URL ตามการตั้งค่า webhook ของคุณใน n8n\nconst N8N_WEBHOOK_URL = 'https://joytrip2.app.n8n.cloud/webhook-test/2e3f1d63-42be-4c89-ae64-fd3cb2cfb9cf'; // URL webhook n8n จริง\n\n// ตั้งค่าให้ใช้โหมดจำลองหรือไม่\nconst USE_MOCK_MODE = false; // ตั้งค่าเป็น false เพื่อใช้การเชื่อมต่อกับ n8n จริง\n\ninterface MessageResponse {\n  text: string;\n  weather?: {\n    location: string;\n    temperature: number;\n    condition: string;\n  };\n  // สามารถเพิ่ม fields อื่นๆ ตามที่ n8n workflow ส่งกลับมา\n}\n\n// คำตอบจำลองสำหรับการทดสอบ\nconst mockResponses: Record<string, MessageResponse> = {\n  default: {\n    text: 'ฉันเป็น AI ผู้ช่วยการท่องเที่ยวของคุณ และพร้อมช่วยวางแผนการเดินทางให้คุณ',\n  },\n  weather: {\n    text: 'ขณะนี้สภาพอากาศในกรุงเทพฯ ร้อนมาก ไม่เหมาะกับการท่องเที่ยวกลางแจ้ง แนะนำให้เที่ยวในห้างสรรพสินค้าหรือพิพิธภัณฑ์',\n    weather: {\n      location: 'กรุงเทพมหานคร',\n      temperature: 32,\n      condition: 'แดดจัด',\n    },\n  },\n  hotel: {\n    text: 'ฉันแนะนำโรงแรมในย่านสุขุมวิทที่เดินทางสะดวก ใกล้รถไฟฟ้า BTS และมีร้านอาหารดีๆ มากมายในบริเวณนั้น',\n  },\n  food: {\n    text: 'อาหารไทยที่คุณไม่ควรพลาดเมื่อมาเที่ยวประเทศไทย ได้แก่ ต้มยำกุ้ง ผัดไทย ส้มตำ และมัสมั่น ซึ่งเคยติดอันดับอาหารอร่อยที่สุดในโลก',\n  },\n  temple: {\n    text: 'วัดที่มีชื่อเสียงในกรุงเทพฯ ได้แก่ วัดพระแก้ว วัดอรุณ และวัดพระเชตุพนฯ (วัดโพธิ์) ซึ่งทั้งหมดอยู่ในเขตพระนคร สามารถเดินทางต่อเนื่องกันได้',\n  },\n};\n\n/**\n * ส่งข้อความไปยัง n8n webhook และรับคำตอบกลับ\n * หรือใช้คำตอบจำลองในโหมดทดสอบ\n */\nexport const sendMessageToN8n = async (message: string): Promise<MessageResponse> => {\n  // ถ้าอยู่ในโหมดจำลอง ให้ใช้ข้อมูลจำลอง\n  if (USE_MOCK_MODE) {\n    await new Promise(resolve => setTimeout(resolve, 1000)); // จำลองความล่าช้าของเครือข่าย 1 วินาที\n    \n    // ตรวจสอบข้อความและเลือกคำตอบที่เหมาะสม\n    const lowercaseMessage = message.toLowerCase();\n    if (lowercaseMessage.includes('อากาศ') || lowercaseMessage.includes('weather')) {\n      return mockResponses.weather;\n    } else if (lowercaseMessage.includes('โรงแรม') || lowercaseMessage.includes('hotel')) {\n      return mockResponses.hotel;\n    } else if (lowercaseMessage.includes('อาหาร') || lowercaseMessage.includes('food')) {\n      return mockResponses.food;\n    } else if (lowercaseMessage.includes('วัด') || lowercaseMessage.includes('temple')) {\n      return mockResponses.temple;\n    } else {\n      return mockResponses.default;\n    }\n  }\n  \n  // หากไม่ได้อยู่ในโหมดจำลอง ให้เชื่อมต่อกับ webhook จริง\n  try {\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), 10000); // timeout หลัง 10 วินาที\n    \n    const response = await fetch(N8N_WEBHOOK_URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        message,\n        timestamp: new Date().toISOString(),\n        sessionId: 'joytrip-user-session-' + new Date().getTime(), // เพิ่ม sessionId ที่ไม่ซ้ำ\n      }),\n      signal: controller.signal\n    });\n    \n    clearTimeout(timeoutId);\n\n    if (!response.ok) {\n      throw new Error(`Error: ${response.status}`);\n    }\n\n    // ตรวจสอบ Content-Type ของ response\n    const contentType = response.headers.get('content-type');\n    console.log('Response content type:', contentType);\n    \n    let data;\n    try {\n      // ถ้าเป็น JSON ให้แปลงเป็น object\n      if (contentType && contentType.includes('application/json')) {\n        try {\n          data = await response.json();\n        } catch (jsonError) {\n          console.error('JSON parsing error:', jsonError);\n          // ถ้า JSON ไม่ถูกต้อง ให้ลองอ่านเป็นข้อความแทน\n          const textResponse = await response.clone().text();\n          console.log('Raw response text:', textResponse);\n          // ใช้ข้อความโดยตรงถ้ามี\n          if (textResponse && textResponse.trim()) {\n            data = textResponse;\n          } else {\n            data = { text: 'ไม่มีคำตอบจากเซิร์ฟเวอร์ โปรดลองอีกครั้งภายหลัง' };\n          }\n        }\n      } \n      // ถ้าเป็น text ให้ใช้ข้อความโดยตรง\n      else {\n        const textData = await response.text();\n        console.log('Text data received:', textData);\n        \n        // ถ้าไม่มีข้อความ\n        if (!textData || textData.trim() === '') {\n          data = { text: 'ไม่มีคำตอบจากเซิร์ฟเวอร์ กรุณาลองอีกครั้ง' };\n        } else {\n          // ลองแปลงเป็น JSON ถ้าทำได้\n          try {\n            data = JSON.parse(textData);\n          } catch (e) {\n            // ถ้าแปลงไม่ได้ ให้ใช้เป็นข้อความโดยตรง\n            data = textData;\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Error processing response:', error);\n      data = { text: 'เกิดข้อผิดพลาดในการประมวลผลคำตอบ' };\n    }\n    \n    console.log('Data received from n8n:', data);\n    \n    // ตรวจสอบรูปแบบข้อมูลและแก้ไขให้ตรงกับที่แอพต้องการ\n    let messageText = 'ไม่สามารถประมวลผลคำตอบได้';\n    let weatherData = undefined;\n    \n    // ลองหาข้อมูลในหลายรูปแบบที่เป็นไปได้\n    if (typeof data === 'object') {\n      // ให้ความสำคัญกับ field 'output' ที่เห็นจากรูปภาพก่อน\n      if (data.output && typeof data.output === 'string') {\n        console.log('Found output field in JSON:', data.output);\n        messageText = data.output;\n      }\n      // ตรวจสอบรูปแบบมาตรฐานของเรา\n      else if (typeof data.text === 'string') {\n        messageText = data.text;\n        weatherData = data.weather;\n      }\n      // รูปแบบอื่นๆ ที่ n8n อาจส่งกลับมา\n      else if (typeof data.message === 'string') {\n        messageText = data.message;\n      }\n      else if (data.response && typeof data.response.text === 'string') {\n        messageText = data.response.text;\n        weatherData = data.response.weather;\n      }\n      else if (data.content && typeof data.content === 'string') {\n        messageText = data.content;\n      }\n      else if (data.result && typeof data.result === 'string') {\n        messageText = data.result;\n      }\n      // รองรับกรณีเกิด error ในโหนด AI ของ n8n \n      else if (data.error && typeof data.error === 'string') {\n        messageText = `เกิดข้อผิดพลาด: ${data.error}`;\n      }\n    }\n    // กรณีที่ข้อมูลเป็น string ทั้งหมด\n    else if (typeof data === 'string') {\n      // ถ้าเป็นข้อความโดยตรงจาก n8n ก็ใช้เลย\n      messageText = data.trim();\n      console.log('Using direct text message from n8n:', messageText);\n    }\n    \n    const formattedResponse: MessageResponse = {\n      text: messageText,\n      weather: weatherData\n    };\n    \n    console.log('Formatted response:', formattedResponse);\n    return formattedResponse;\n  } catch (error) {\n    console.error('Error sending message to n8n:', error);\n    \n    // ถ้าเกิดข้อผิดพลาด ให้ใช้คำตอบจากโหมดจำลองแทน\n    const lowercaseMessage = message.toLowerCase();\n    if (lowercaseMessage.includes('อากาศ') || lowercaseMessage.includes('weather')) {\n      return mockResponses.weather;\n    } else {\n      return {\n        text: 'ขออภัย ฉันไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้ในขณะนี้ กำลังทำงานในโหมดออฟไลน์ คุณสามารถถามคำถามพื้นฐานได้',\n      };\n    }\n  }\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 496, "column": 0}, "map": {"version":3,"sources":["file:///Users/nui/Documents/trip/JoyTrip-main-v2/src/app/chat/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useRef, useEffect } from 'react';\nimport Navbar from '../components/Navbar';\nimport Footer from '../components/Footer';\nimport ChatMessage from '../components/ChatMessage';\nimport { sendMessageToN8n } from '../utils/n8nService';\n\ninterface Message {\n  role: 'user' | 'bot';\n  text: string;\n  weather?: {\n    location: string;\n    temperature: number;\n    condition: string;\n  };\n}\n\nexport default function ChatbotPage() {\n  const [messages, setMessages] = useState<Message[]>([\n    { role: 'bot', text: 'Hi! How can I assist you with your trip planning today?' },\n  ]);\n  const [input, setInput] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  \n  // ฟังก์ชันเลื่อนไปยังข้อความล่าสุด\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n  \n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const handleSend = async () => {\n    if (!input.trim() || isLoading) return;\n    \n    const userMessage = input;\n    setInput('');\n    setIsLoading(true);\n    \n    // เพิ่มข้อความของผู้ใช้ลงในรายการข้อความ\n    setMessages((prev) => [...prev, { role: 'user', text: userMessage }]);\n    \n    try {\n      // ส่งข้อความไปยัง n8n webhook\n      const response = await sendMessageToN8n(userMessage);\n      \n      // เพิ่มข้อความตอบกลับจาก n8n ลงในรายการข้อความ\n      setMessages((prev) => [\n        ...prev, \n        { \n          role: 'bot', \n          text: response.text,\n          weather: response.weather\n        }\n      ]);\n    } catch (error) {\n      console.error('Error handling message:', error);\n      setMessages((prev) => [\n        ...prev,\n        { \n          role: 'bot', \n          text: 'Sorry, I encountered a problem. Please try again later.'\n        }\n      ]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col font-sans bg-white\">\n      <Navbar />\n\n      <main className=\"flex-1 flex justify-center bg-gradient-to-b from-blue-50 to-white px-4 py-10 mb-50\">\n        <div className=\"w-full max-w-3xl flex flex-col bg-white shadow-xl rounded-xl border border-gray-200\">\n          {/* Header */}\n          <div className=\"bg-blue-600 text-white text-center py-4 rounded-t-xl font-semibold text-lg\">\n            ✈️ JoyTrip AI Travel Assistant\n          </div>\n\n          {/* Messages */}\n          <div className=\"flex-1 px-4 py-6 space-y-4 overflow-y-auto\" style={{ maxHeight: '70vh' }}>\n            {messages.map((msg, i) => (\n              <ChatMessage\n                key={i}\n                role={msg.role}\n                text={msg.text}\n                weather={msg.weather}\n              />\n            ))}\n            {isLoading && (\n              <div className=\"flex justify-start\">\n                <div className=\"px-5 py-3 rounded-lg shadow-md bg-gray-100 text-gray-800 rounded-bl-none flex items-center\">\n                  <div className=\"flex space-x-2\">\n                    <div className=\"h-3 w-3 bg-blue-600 rounded-full animate-bounce\"></div>\n                    <div className=\"h-3 w-3 bg-blue-600 rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\n                    <div className=\"h-3 w-3 bg-blue-600 rounded-full animate-bounce\" style={{ animationDelay: '0.4s' }}></div>\n                  </div>\n                </div>\n              </div>\n            )}\n            <div ref={messagesEndRef} />\n          </div>\n\n          {/* Input */}\n          <div className=\"border-t border-gray-200 p-4 flex gap-2 bg-white\">\n            <input\n              type=\"text\"\n              value={input}\n              onChange={(e) => setInput(e.target.value)}\n              onKeyDown={(e) => e.key === 'Enter' && handleSend()}\n              placeholder=\"Ask your travel assistant...\"\n              className=\"flex-grow rounded-full border border-gray-300 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              autoFocus\n              disabled={isLoading}\n            />\n            <button\n              onClick={handleSend}\n              className={`${isLoading ? 'bg-blue-400' : 'bg-blue-600 hover:bg-blue-700'} text-white rounded-full px-6 py-3 font-semibold transition`}\n              disabled={isLoading}\n            >\n              {isLoading ? 'Sending...' : 'Send'}\n            </button>\n          </div>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;AAkBe,SAAS;IACtB,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAa;QAClD;YAAE,MAAM;YAAO,MAAM;QAA0D;KAChF;IACD,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,iBAAiB,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAkB;IAE9C,mCAAmC;IACnC,MAAM,iBAAiB;QACrB,eAAe,OAAO,EAAE,eAAe;YAAE,UAAU;QAAS;IAC9D;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR;IACF,GAAG;QAAC;KAAS;IAEb,MAAM,aAAa;QACjB,IAAI,CAAC,MAAM,IAAI,MAAM,WAAW;QAEhC,MAAM,cAAc;QACpB,SAAS;QACT,aAAa;QAEb,yCAAyC;QACzC,YAAY,CAAC,OAAS;mBAAI;gBAAM;oBAAE,MAAM;oBAAQ,MAAM;gBAAY;aAAE;QAEpE,IAAI;YACF,8BAA8B;YAC9B,MAAM,WAAW,MAAM,CAAA,GAAA,iIAAA,CAAA,mBAAgB,AAAD,EAAE;YAExC,+CAA+C;YAC/C,YAAY,CAAC,OAAS;uBACjB;oBACH;wBACE,MAAM;wBACN,MAAM,SAAS,IAAI;wBACnB,SAAS,SAAS,OAAO;oBAC3B;iBACD;QACH,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,YAAY,CAAC,OAAS;uBACjB;oBACH;wBACE,MAAM;wBACN,MAAM;oBACR;iBACD;QACH,SAAU;YACR,aAAa;QACf;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,mIAAA,CAAA,UAAM;;;;;0BAEP,8OAAC;gBAAK,WAAU;0BACd,cAAA,8OAAC;oBAAI,WAAU;;sCAEb,8OAAC;4BAAI,WAAU;sCAA6E;;;;;;sCAK5F,8OAAC;4BAAI,WAAU;4BAA6C,OAAO;gCAAE,WAAW;4BAAO;;gCACpF,SAAS,GAAG,CAAC,CAAC,KAAK,kBAClB,8OAAC,wIAAA,CAAA,UAAW;wCAEV,MAAM,IAAI,IAAI;wCACd,MAAM,IAAI,IAAI;wCACd,SAAS,IAAI,OAAO;uCAHf;;;;;gCAMR,2BACC,8OAAC;oCAAI,WAAU;8CACb,cAAA,8OAAC;wCAAI,WAAU;kDACb,cAAA,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAI,WAAU;;;;;;8DACf,8OAAC;oDAAI,WAAU;oDAAkD,OAAO;wDAAE,gBAAgB;oDAAO;;;;;;8DACjG,8OAAC;oDAAI,WAAU;oDAAkD,OAAO;wDAAE,gBAAgB;oDAAO;;;;;;;;;;;;;;;;;;;;;;8CAKzG,8OAAC;oCAAI,KAAK;;;;;;;;;;;;sCAIZ,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCACC,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;oCACxC,WAAW,CAAC,IAAM,EAAE,GAAG,KAAK,WAAW;oCACvC,aAAY;oCACZ,WAAU;oCACV,SAAS;oCACT,UAAU;;;;;;8CAEZ,8OAAC;oCACC,SAAS;oCACT,WAAW,GAAG,YAAY,gBAAgB,gCAAgC,2DAA2D,CAAC;oCACtI,UAAU;8CAET,YAAY,eAAe;;;;;;;;;;;;;;;;;;;;;;;0BAMpC,8OAAC,mIAAA,CAAA,UAAM;;;;;;;;;;;AAGb","debugId":null}}]
}